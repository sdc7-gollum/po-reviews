CREATE SCHEMA stays AUTHORIZATION postgres;

CREATE TABLE IF NOT EXISTS reviews
(
  stay_id  NUMERIC (12,4) NOT NULL,
  name VARCHAR(50),
  pic VARCHAR(255),
  date DATE,
  body VARCHAR,
  r_checking SMALLINT,
  r_accuracy SMALLINT,
  r_location SMALLINT,
  r_communication SMALLINT,
  r_cleanliness SMALLINT,
  r_value SMALLINT
) PARTITION BY RANGE (stay_id);


CREATE TABLE IF NOT EXISTS reviews_1 PARTITION OF reviews
  FOR VALUES FROM (1) TO (100001);

CREATE TABLE IF NOT EXISTS reviews_2 PARTITION OF reviews
  FOR VALUES FROM (100001) TO (200001);

CREATE TABLE IF NOT EXISTS reviews_3 PARTITION OF reviews
  FOR VALUES FROM (200001) TO (300001);

CREATE TABLE IF NOT EXISTS reviews_4 PARTITION OF reviews
  FOR VALUES FROM (300001) TO (400001);

CREATE TABLE IF NOT EXISTS reviews_5 PARTITION OF reviews
  FOR VALUES FROM (400001) TO (500001);

CREATE TABLE IF NOT EXISTS reviews_6 PARTITION OF reviews
  FOR VALUES FROM (500001) TO (600001);

CREATE TABLE IF NOT EXISTS reviews_7 PARTITION OF reviews
  FOR VALUES FROM (600001) TO (700001);

CREATE TABLE IF NOT EXISTS reviews_8 PARTITION OF reviews
  FOR VALUES FROM (700001) TO (800001);

CREATE TABLE IF NOT EXISTS reviews_9 PARTITION OF reviews
  FOR VALUES FROM (800001) TO (900001);

CREATE TABLE IF NOT EXISTS reviews_10 PARTITION OF reviews
  FOR VALUES FROM (900001) TO (1000001);

CREATE TABLE IF NOT EXISTS reviews_11 PARTITION OF reviews
  FOR VALUES FROM (1000001) TO (1100001);

CREATE TABLE IF NOT EXISTS reviews_12 PARTITION OF reviews
  FOR VALUES FROM (1100001) TO (1200001);

CREATE TABLE IF NOT EXISTS reviews_13 PARTITION OF reviews
  FOR VALUES FROM (1200001) TO (1300001);

CREATE TABLE IF NOT EXISTS reviews_14 PARTITION OF reviews
  FOR VALUES FROM (1300001) TO (1400001);

CREATE TABLE IF NOT EXISTS reviews_15 PARTITION OF reviews
  FOR VALUES FROM (1400001) TO (1500001);

CREATE TABLE IF NOT EXISTS reviews_16 PARTITION OF reviews
  FOR VALUES FROM (1500001) TO (1600001);

CREATE TABLE IF NOT EXISTS reviews_17 PARTITION OF reviews
  FOR VALUES FROM (1600001) TO (1700001);

CREATE TABLE IF NOT EXISTS reviews_18 PARTITION OF reviews
  FOR VALUES FROM (1700001) TO (1800001);

CREATE TABLE IF NOT EXISTS reviews_19 PARTITION OF reviews
  FOR VALUES FROM (1800001) TO (1900001);

CREATE TABLE IF NOT EXISTS reviews_20 PARTITION OF reviews
  FOR VALUES FROM (1900001) TO (2000001);

CREATE TABLE IF NOT EXISTS reviews_21 PARTITION OF reviews
  FOR VALUES FROM (2000001) TO (2100001);

CREATE TABLE IF NOT EXISTS reviews_22 PARTITION OF reviews
  FOR VALUES FROM (2100001) TO (2200001);

CREATE TABLE IF NOT EXISTS reviews_23 PARTITION OF reviews
  FOR VALUES FROM (2200001) TO (2300001);

CREATE TABLE IF NOT EXISTS reviews_24 PARTITION OF reviews
  FOR VALUES FROM (2300001) TO (2400001);

CREATE TABLE IF NOT EXISTS reviews_25 PARTITION OF reviews
  FOR VALUES FROM (2400001) TO (2500001);

CREATE TABLE IF NOT EXISTS reviews_26 PARTITION OF reviews
  FOR VALUES FROM (2500001) TO (2600001);

CREATE TABLE IF NOT EXISTS reviews_27 PARTITION OF reviews
  FOR VALUES FROM (2600001) TO (2700001);

CREATE TABLE IF NOT EXISTS reviews_28 PARTITION OF reviews
  FOR VALUES FROM (2700001) TO (2800001);

CREATE TABLE IF NOT EXISTS reviews_29 PARTITION OF reviews
  FOR VALUES FROM (2800001) TO (2900001);

CREATE TABLE IF NOT EXISTS reviews_30 PARTITION OF reviews
  FOR VALUES FROM (2900001) TO (3000001);

CREATE TABLE IF NOT EXISTS reviews_31 PARTITION OF reviews
  FOR VALUES FROM (3000001) TO (3100001);

CREATE TABLE IF NOT EXISTS reviews_32 PARTITION OF reviews
  FOR VALUES FROM (3100001) TO (3200001);

CREATE TABLE IF NOT EXISTS reviews_33 PARTITION OF reviews
  FOR VALUES FROM (3200001) TO (3300001);

CREATE TABLE IF NOT EXISTS reviews_34 PARTITION OF reviews
  FOR VALUES FROM (3300001) TO (3400001);

CREATE TABLE IF NOT EXISTS reviews_35 PARTITION OF reviews
  FOR VALUES FROM (3400001) TO (3500001);

CREATE TABLE IF NOT EXISTS reviews_36 PARTITION OF reviews
  FOR VALUES FROM (3500001) TO (3600001);

CREATE TABLE IF NOT EXISTS reviews_37 PARTITION OF reviews
  FOR VALUES FROM (3600001) TO (3700001);

CREATE TABLE IF NOT EXISTS reviews_38 PARTITION OF reviews
  FOR VALUES FROM (3700001) TO (3800001);

CREATE TABLE IF NOT EXISTS reviews_39 PARTITION OF reviews
  FOR VALUES FROM (3800001) TO (3900001);

CREATE TABLE IF NOT EXISTS reviews_40 PARTITION OF reviews
  FOR VALUES FROM (3900001) TO (4000001);

CREATE TABLE IF NOT EXISTS reviews_41 PARTITION OF reviews
  FOR VALUES FROM (4000001) TO (4100001);

CREATE TABLE IF NOT EXISTS reviews_42 PARTITION OF reviews
  FOR VALUES FROM (4100001) TO (4200001);

CREATE TABLE IF NOT EXISTS reviews_43 PARTITION OF reviews
  FOR VALUES FROM (4200001) TO (4300001);

CREATE TABLE IF NOT EXISTS reviews_44 PARTITION OF reviews
  FOR VALUES FROM (4300001) TO (4400001);

CREATE TABLE IF NOT EXISTS reviews_45 PARTITION OF reviews
  FOR VALUES FROM (4400001) TO (4500001);

CREATE TABLE IF NOT EXISTS reviews_46 PARTITION OF reviews
  FOR VALUES FROM (4500001) TO (4600001);

CREATE TABLE IF NOT EXISTS reviews_47 PARTITION OF reviews
  FOR VALUES FROM (4600001) TO (4700001);

CREATE TABLE IF NOT EXISTS reviews_48 PARTITION OF reviews
  FOR VALUES FROM (4700001) TO (4800001);

CREATE TABLE IF NOT EXISTS reviews_49 PARTITION OF reviews
  FOR VALUES FROM (4800001) TO (4900001);

CREATE TABLE IF NOT EXISTS reviews_50 PARTITION OF reviews
  FOR VALUES FROM (4900001) TO (5000001);

CREATE TABLE IF NOT EXISTS reviews_51 PARTITION OF reviews
  FOR VALUES FROM (5000001) TO (5100001);

CREATE TABLE IF NOT EXISTS reviews_52 PARTITION OF reviews
  FOR VALUES FROM (5100001) TO (5200001);

CREATE TABLE IF NOT EXISTS reviews_53 PARTITION OF reviews
  FOR VALUES FROM (5200001) TO (5300001);

CREATE TABLE IF NOT EXISTS reviews_54 PARTITION OF reviews
  FOR VALUES FROM (5300001) TO (5400001);

CREATE TABLE IF NOT EXISTS reviews_55 PARTITION OF reviews
  FOR VALUES FROM (5400001) TO (5500001);

CREATE TABLE IF NOT EXISTS reviews_56 PARTITION OF reviews
  FOR VALUES FROM (5500001) TO (5600001);

CREATE TABLE IF NOT EXISTS reviews_57 PARTITION OF reviews
  FOR VALUES FROM (5600001) TO (5700001);

CREATE TABLE IF NOT EXISTS reviews_58 PARTITION OF reviews
  FOR VALUES FROM (5700001) TO (5800001);

CREATE TABLE IF NOT EXISTS reviews_59 PARTITION OF reviews
  FOR VALUES FROM (5800001) TO (5900001);

CREATE TABLE IF NOT EXISTS reviews_60 PARTITION OF reviews
  FOR VALUES FROM (5900001) TO (6000001);

CREATE TABLE IF NOT EXISTS reviews_61 PARTITION OF reviews
  FOR VALUES FROM (6000001) TO (6100001);

CREATE TABLE IF NOT EXISTS reviews_62 PARTITION OF reviews
  FOR VALUES FROM (6100001) TO (6200001);

CREATE TABLE IF NOT EXISTS reviews_63 PARTITION OF reviews
  FOR VALUES FROM (6200001) TO (6300001);

CREATE TABLE IF NOT EXISTS reviews_64 PARTITION OF reviews
  FOR VALUES FROM (6300001) TO (6400001);

CREATE TABLE IF NOT EXISTS reviews_65 PARTITION OF reviews
  FOR VALUES FROM (6400001) TO (6500001);

CREATE TABLE IF NOT EXISTS reviews_66 PARTITION OF reviews
  FOR VALUES FROM (6500001) TO (6600001);

CREATE TABLE IF NOT EXISTS reviews_67 PARTITION OF reviews
  FOR VALUES FROM (6600001) TO (6700001);

CREATE TABLE IF NOT EXISTS reviews_68 PARTITION OF reviews
  FOR VALUES FROM (6700001) TO (6800001);

CREATE TABLE IF NOT EXISTS reviews_69 PARTITION OF reviews
  FOR VALUES FROM (6800001) TO (6900001);

CREATE TABLE IF NOT EXISTS reviews_70 PARTITION OF reviews
  FOR VALUES FROM (6900001) TO (7000001);

CREATE TABLE IF NOT EXISTS reviews_71 PARTITION OF reviews
  FOR VALUES FROM (7000001) TO (7100001);

CREATE TABLE IF NOT EXISTS reviews_72 PARTITION OF reviews
  FOR VALUES FROM (7100001) TO (7200001);

CREATE TABLE IF NOT EXISTS reviews_73 PARTITION OF reviews
  FOR VALUES FROM (7200001) TO (7300001);

CREATE TABLE IF NOT EXISTS reviews_74 PARTITION OF reviews
  FOR VALUES FROM (7300001) TO (7400001);

CREATE TABLE IF NOT EXISTS reviews_75 PARTITION OF reviews
  FOR VALUES FROM (7400001) TO (7500001);

CREATE TABLE IF NOT EXISTS reviews_76 PARTITION OF reviews
  FOR VALUES FROM (7500001) TO (7600001);

CREATE TABLE IF NOT EXISTS reviews_77 PARTITION OF reviews
  FOR VALUES FROM (7600001) TO (7700001);

CREATE TABLE IF NOT EXISTS reviews_78 PARTITION OF reviews
  FOR VALUES FROM (7700001) TO (7800001);

CREATE TABLE IF NOT EXISTS reviews_79 PARTITION OF reviews
  FOR VALUES FROM (7800001) TO (7900001);

CREATE TABLE IF NOT EXISTS reviews_80 PARTITION OF reviews
  FOR VALUES FROM (7900001) TO (8000001);

CREATE TABLE IF NOT EXISTS reviews_81 PARTITION OF reviews
  FOR VALUES FROM (8000001) TO (8100001);

CREATE TABLE IF NOT EXISTS reviews_82 PARTITION OF reviews
  FOR VALUES FROM (8100001) TO (8200001);

CREATE TABLE IF NOT EXISTS reviews_83 PARTITION OF reviews
  FOR VALUES FROM (8200001) TO (8300001);

CREATE TABLE IF NOT EXISTS reviews_84 PARTITION OF reviews
  FOR VALUES FROM (8300001) TO (8400001);

CREATE TABLE IF NOT EXISTS reviews_85 PARTITION OF reviews
  FOR VALUES FROM (8400001) TO (8500001);

CREATE TABLE IF NOT EXISTS reviews_86 PARTITION OF reviews
  FOR VALUES FROM (8500001) TO (8600001);

CREATE TABLE IF NOT EXISTS reviews_87 PARTITION OF reviews
  FOR VALUES FROM (8600001) TO (8700001);

CREATE TABLE IF NOT EXISTS reviews_88 PARTITION OF reviews
  FOR VALUES FROM (8700001) TO (8800001);

CREATE TABLE IF NOT EXISTS reviews_89 PARTITION OF reviews
  FOR VALUES FROM (8800001) TO (8900001);

CREATE TABLE IF NOT EXISTS reviews_90 PARTITION OF reviews
  FOR VALUES FROM (8900001) TO (9000001);

CREATE TABLE IF NOT EXISTS reviews_91 PARTITION OF reviews
  FOR VALUES FROM (9000001) TO (9100001);

CREATE TABLE IF NOT EXISTS reviews_92 PARTITION OF reviews
  FOR VALUES FROM (9100001) TO (9200001);

CREATE TABLE IF NOT EXISTS reviews_93 PARTITION OF reviews
  FOR VALUES FROM (9200001) TO (9300001);

CREATE TABLE IF NOT EXISTS reviews_94 PARTITION OF reviews
  FOR VALUES FROM (9300001) TO (9400001);

CREATE TABLE IF NOT EXISTS reviews_95 PARTITION OF reviews
  FOR VALUES FROM (9400001) TO (9500001);

CREATE TABLE IF NOT EXISTS reviews_96 PARTITION OF reviews
  FOR VALUES FROM (9500001) TO (9600001);

CREATE TABLE IF NOT EXISTS reviews_97 PARTITION OF reviews
  FOR VALUES FROM (9600001) TO (9700001);

CREATE TABLE IF NOT EXISTS reviews_98 PARTITION OF reviews
  FOR VALUES FROM (9700001) TO (9800001);

CREATE TABLE IF NOT EXISTS reviews_99 PARTITION OF reviews
  FOR VALUES FROM (9800001) TO (9900001);

CREATE TABLE IF NOT EXISTS reviews_100 PARTITION OF reviews
  FOR VALUES FROM (9900001) TO (10000001);


COPY reviews FROM '/home/ubuntu/po-reviews/reviews.csv' DELIMITER ',' CSV HEADER;